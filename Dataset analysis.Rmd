---
title: "My Dataset"
output: "github_document"
date: "2024-09-26"
---
```{r}
# Set a CRAN mirror
options(repos = c(CRAN = "https://cran.rstudio.com/"))

# Install the nortest package
install.packages("nortest")

```

```{r}
install.packages("dplyr")
library(car)
library(dplyr) #recode variables
#library(tidyr)
library(ggplot2)
#library(psych)
#library(bruceR)
library(haven) #load CSV

install.packages("nortest")

library(nortest)
#install.packages("car")
```
Reading dataset 
```{r}
# Set working directory
#setwd("C:/Users/sidne/OneDrive/Documents/GitHub/myproject")

# Read the TSV file
data <- read.table("C:/Users/sidne/OneDrive/Desktop/PSY329/38964-0001-Data.tsv", sep = "\t", header = TRUE, fill = TRUE, quote = "")

# Write the data to a CSV file
write.csv(data, "Excel-Data.csv", row.names = FALSE)

#open file
data <- read.csv("C:/Users/sidne/OneDrive/Desktop/PSY329/Excel-Data.csv")

```

Cleaning data set and recoding variables
```{r}
clean_data <- data %>%
  select(SEX,HHINC,HAPPY,SAT1,SAT2,SAT3,SAT4,SAT5,LONELY_A,LONELY_B,LONELY_C) 

clean_data$SEX<-recode(data$SEX, '1' = 'Male', '2' = 'Female', '3'='Other')

#clean_data$RACEREC<-recode(data$RACEREC, '1'='White','2'='Black','3'='Indigenous American','4'='Hispanic','5'='Asian','6'= 'Other', '98'='Unknown') I don't think I am going to use race

clean_data$HOUSE_INCOME<-recode(data$HHINC, '1' = '<10K', '2' = '10K-24K', '3'='25k-39k','4'='40k-49k','5'='50K-59K','6'='60K-74K','7'='75K-84K','8'='85K-99K','9'='100K-124K','10'='125K-149K','11'='150K-199K','12'='200k+')

clean_data$HAPPY_meaning<-recode(data$HAPPY, '1' = 'Very happy', '2' = 'Rather happy', '3'='Not very happy','4'='Not at all happy')

clean_data <- clean_data %>%
   mutate(Lonely=rowMeans(cbind(LONELY_A,LONELY_B,LONELY_C))) #1 hardly ever feel lonely to 5 often feel lonely 

clean_data <- clean_data %>%
  mutate(Lonely = ifelse(Lonely > 3, NA, Lonely)) #removing participants that responded don't know or refused the question

clean_data <- clean_data %>%
   mutate(Life_satisfaction=rowMeans(cbind(SAT1,SAT2,SAT3,SAT4,SAT5))) #1 strongly disagree to 5 strongly agree higher score = higher life satisfaction

clean_data <- clean_data %>%
  mutate(Life_satisfaction = ifelse(Life_satisfaction > 5, NA, Life_satisfaction))

write.csv(clean_data, "C:/Users/sidne/OneDrive/Desktop/PSY329/clean_data.csv", row.names = FALSE)

```

Checking normality
```{r}

ggplot(clean_data, aes(x = Lonely)) + geom_histogram(binwidth = 0.1) + theme_classic()

ggplot(clean_data, aes(x = Life_satisfaction)) + geom_histogram(binwidth = 0.1) + theme_classic()

ggplot(clean_data, aes(x = HAPPY)) + geom_histogram(binwidth = 0.1) + theme_classic()



# Anderson-Darling test for Lonely
ad.test(clean_data$Lonely)

# Anderson-Darling test for Life_satisfaction
ad.test(clean_data$Life_satisfaction)

# Anderson-Darling test for Happiness
ad.test(clean_data$HAPPY)

#all 3 variables show a non normal distribution as shown in the ggplot and the Anderson-darling test since p<0.05 and a large A value
```
```{r}
leveneTest(Lonely~SEX, clean_data)

leveneTest(Life_satisfaction~SEX, clean_data)

leveneTest(HAPPY~SEX, clean_data)
```



```{r}
model <- lm(Life_satisfaction ~ SEX, data = clean_data)
plot(residuals(model))

install.packages("lmtest")
library(lmtest)
dwtest(model)


```

